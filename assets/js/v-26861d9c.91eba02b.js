(self.webpackChunkscriptcat_org=self.webpackChunkscriptcat_org||[]).push([[208],{8133:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>p});const p={key:"v-26861d9c",path:"/dev/api.html",title:"API 文档",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"说明",slug:"说明",children:[]},{level:2,title:"定义",slug:"定义",children:[{level:3,title:"GM_cookie",slug:"gm-cookie",children:[]},{level:3,title:"GM_notification *",slug:"gm-notification",children:[]},{level:3,title:"GM_xmlhttpRequest *",slug:"gm-xmlhttprequest",children:[]},{level:3,title:"GM_log *",slug:"gm-log",children:[]},{level:3,title:"GM_get/set/deleteValue",slug:"gm-get-set-deletevalue",children:[]},{level:3,title:"GM_add/removeValueChangeListener *",slug:"gm-add-removevaluechangelistener",children:[]},{level:3,title:"GM_openInTab",slug:"gm-openintab",children:[]},{level:3,title:"GM_get/saveTab/GM_getTabs",slug:"gm-get-savetab-gm-gettabs",children:[]},{level:3,title:"GM_setClipboard",slug:"gm-setclipboard",children:[]},{level:3,title:"GM_addStyle",slug:"gm-addstyle",children:[]},{level:3,title:"GM_registerMenuCommand",slug:"gm-registermenucommand",children:[]},{level:3,title:"GM_unregisterMenuCommand",slug:"gm-unregistermenucommand",children:[]},{level:3,title:"GM_getResourceText/GM_getResourceURL",slug:"gm-getresourcetext-gm-getresourceurl",children:[]},{level:3,title:"GM_download",slug:"gm-download",children:[]}]}],filePathRelative:"dev/api.md",git:{updatedTime:16421573e5,contributors:[]}}},2739:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>f});var p=a(6252);const e=(0,p.Wm)("h1",{id:"api-文档",tabindex:"-1"},[(0,p.Wm)("a",{class:"header-anchor",href:"#api-文档","aria-hidden":"true"},"#"),(0,p.Uk)(" API 文档")],-1),t=(0,p.Wm)("h2",{id:"说明",tabindex:"-1"},[(0,p.Wm)("a",{class:"header-anchor",href:"#说明","aria-hidden":"true"},"#"),(0,p.Uk)(" 说明")],-1),o=(0,p.Uk)("本扩展api定义参考"),l={href:"https://www.tampermonkey.net/documentation.php",target:"_blank",rel:"noopener noreferrer"},c=(0,p.Uk)("tampermonkey文档"),r=(0,p.Uk)(",由于时间和精力问题,只实现了部分API,后续将继续迭代,本扩展进行扩充或者与原GM不同的API将在文档中特殊标注(使用*号).对于某些API还提供了同步函数,同步函数规则:GM.*,具体请看文档内容."),i=(0,p.Uk)("API的详细定义,请看"),u=(0,p.Wm)("code",null,"tempermonkey.d.ts",-1),k=(0,p.Uk)("或者内置编辑器提示,文档更新可能不会及时.对于本扩展特有的API请看"),b=(0,p.Uk)("CatApi文档"),d=(0,p.uE)('<h2 id="定义" tabindex="-1"><a class="header-anchor" href="#定义" aria-hidden="true">#</a> 定义</h2><h3 id="gm-cookie" tabindex="-1"><a class="header-anchor" href="#gm-cookie" aria-hidden="true">#</a> GM_cookie</h3><blockquote><p>必须使用<code>@connect</code>声明操作的host,且经过用户授权才可使用.虽然兼容TM的<code>GM_cookie.list</code>操作,但是为了统一,不建议这样.</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_cookie</span><span class="token punctuation">(</span>action<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>CookieAction<span class="token punctuation">,</span> details<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>CookieDetails<span class="token punctuation">,</span> <span class="token function-variable function">ondone</span><span class="token operator">:</span> <span class="token punctuation">(</span>cookie<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>Cookie<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> error<span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n\n<span class="token comment">// store可通过tabid(前后端通信可能用到,ValueChangeListener会返回tabid),获取storeid,后台脚本用.</span>\n<span class="token keyword">declare</span> <span class="token keyword">namespace</span> GM_Types <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> <span class="token class-name">CookieAction</span> <span class="token operator">=</span> <span class="token string">&quot;list&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;delete&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;set&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;store&quot;</span><span class="token punctuation">;</span>\n    <span class="token keyword">interface</span> <span class="token class-name">CookieDetails</span> <span class="token punctuation">{</span>\n        url<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n        name<span class="token operator">:</span> <span class="token builtin">string</span>\n        value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n        domain<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n        path<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n        secure<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n        session<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n        storeId<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n        httpOnly<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n        expirationDate<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>\n    <span class="token punctuation">}</span>\n    <span class="token keyword">interface</span> <span class="token class-name">Cookie</span> <span class="token punctuation">{</span>\n        domain<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n        name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n        storeId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n        value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n        session<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>\n        hostOnly<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>\n        expirationDate<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>\n        path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n        httpOnly<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>\n        secure<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h3 id="gm-notification" tabindex="-1"><a class="header-anchor" href="#gm-notification" aria-hidden="true">#</a> GM_notification *</h3>',5),m=(0,p.Wm)("p",null,[(0,p.Uk)("发送消息通知,提供了"),(0,p.Wm)("code",null,"progress"),(0,p.Uk)("和"),(0,p.Wm)("code",null,"buttons"),(0,p.Uk)("的能力(Firefox不支持),可以显示进度条类型和按钮类型的通知,多提供了"),(0,p.Wm)("code",null,"GM_closeNotification"),(0,p.Uk)(","),(0,p.Wm)("code",null,"GM_updateNotification"),(0,p.Uk)("(Firefox不支持)两个方法.")],-1),g={href:"https://bbs.tampermonkey.net.cn/thread-403-1-1.html",target:"_blank",rel:"noopener noreferrer"},y=(0,p.Uk)("demo"),h=(0,p.uE)('<div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_notification</span><span class="token punctuation">(</span>details<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>NotificationDetails<span class="token punctuation">,</span> ondone<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_notification</span><span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> onclick<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_closeNotification</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_updateNotification</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> details<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>NotificationDetails<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n\n<span class="token keyword">declare</span> <span class="token keyword">namespace</span> GM_Types <span class="token punctuation">{</span>\n\n    <span class="token keyword">type</span> <span class="token class-name">NotificationOnClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> NotificationThis<span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> index<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">;</span>\n    <span class="token keyword">type</span> <span class="token class-name">NotificationOnDone</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> NotificationThis<span class="token punctuation">,</span> clicked<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">interface</span> <span class="token class-name">NotificationButton</span> <span class="token punctuation">{</span>\n        title<span class="token operator">:</span> <span class="token builtin">string</span>\n        iconUrl<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">interface</span> <span class="token class-name">NotificationDetails</span> <span class="token punctuation">{</span>\n        text<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n        title<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n        image<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n        highlight<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n        silent<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n        timeout<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>\n        onclick<span class="token operator">?</span><span class="token operator">:</span> NotificationOnClick\n        ondone<span class="token operator">?</span><span class="token operator">:</span> NotificationOnDone\n        progress<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>\n        oncreate<span class="token operator">?</span><span class="token operator">:</span> NotificationOnClick\n        <span class="token comment">// 只能存在2个</span>\n        buttons<span class="token operator">?</span><span class="token operator">:</span> NotificationButton<span class="token punctuation">[</span><span class="token punctuation">]</span>\n    <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><h3 id="gm-xmlhttprequest" tabindex="-1"><a class="header-anchor" href="#gm-xmlhttprequest" aria-hidden="true">#</a> GM_xmlhttpRequest *</h3><blockquote><p>部分功能缺失,cookie功能firefox暂不支持,需要用户授权才可正常访问,使用<code>@connect</code>描述的host可跳过用户授权,其它需要进行ajax操作的API同理.</p></blockquote><p>对于anonymous和cookie相比tm做了特殊处理,anonymous为true且cookie存在时,发送的cookie为设置的cookie不会带上其他cookie.</p><p>特殊header也是支持的:</p><ul><li>user-agent</li><li>origin,</li><li>referer</li><li>cookie</li><li>host</li><li>...</li></ul><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_xmlhttpRequest</span><span class="token punctuation">(</span>details<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>XHRDetails<span class="token punctuation">)</span><span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>AbortHandle<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">declare</span> <span class="token keyword">namespace</span> GM_Types <span class="token punctuation">{</span>\n    <span class="token keyword">interface</span> <span class="token class-name">XHRResponse</span> <span class="token punctuation">{</span>\n        finalUrl<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        readyState<span class="token operator">?</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token operator">|</span> <span class="token number">1</span> <span class="token operator">|</span> <span class="token number">2</span> <span class="token operator">|</span> <span class="token number">3</span> <span class="token operator">|</span> <span class="token number">4</span><span class="token punctuation">,</span>\n        responseHeaders<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        status<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>\n        statusText<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        response<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span>\n        responseText<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        responseXML<span class="token operator">?</span><span class="token operator">:</span> Document <span class="token operator">|</span> <span class="token keyword">null</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">interface</span> <span class="token class-name">XHRProgress</span> <span class="token keyword">extends</span> <span class="token class-name">XHRResponse</span> <span class="token punctuation">{</span>\n        done<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>\n        lengthComputable<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>\n        loaded<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>\n        position<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>\n        total<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>\n        totalSize<span class="token operator">:</span> <span class="token builtin">number</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">type</span> <span class="token class-name">Listener<span class="token operator">&lt;</span><span class="token constant">OBJ</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token constant">OBJ</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">;</span>\n\n    <span class="token keyword">interface</span> <span class="token class-name">XHRDetails</span> <span class="token punctuation">{</span>\n        method<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#39;GET&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;HEAD&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;POST&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;PUT&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;DELETE&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;PATCH&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;OPTIONS&#39;</span>\n        url<span class="token operator">:</span> <span class="token builtin">string</span>\n        headers<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>\n        data<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> FormData\n        cookie<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n        binary<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n        timeout<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span>\n        responseType<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#39;text&#39;</span> <span class="token operator">|</span><span class="token string">&#39;arraybuffer&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;blob&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;json&#39;</span>\n        overrideMimeType<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        anonymous<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>\n        fetch<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>\n        user<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        password<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        nocache<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n\n        onload<span class="token operator">?</span><span class="token operator">:</span> Listener<span class="token operator">&lt;</span>XHRResponse<span class="token operator">&gt;</span><span class="token punctuation">,</span>\n        onloadstart<span class="token operator">?</span><span class="token operator">:</span> Listener<span class="token operator">&lt;</span>XHRResponse<span class="token operator">&gt;</span><span class="token punctuation">,</span>\n        onloadend<span class="token operator">?</span><span class="token operator">:</span> Listener<span class="token operator">&lt;</span>XHRResponse<span class="token operator">&gt;</span><span class="token punctuation">,</span>\n        onprogress<span class="token operator">?</span><span class="token operator">:</span> Listener<span class="token operator">&lt;</span>XHRProgress<span class="token operator">&gt;</span><span class="token punctuation">,</span>\n        onreadystatechange<span class="token operator">?</span><span class="token operator">:</span> Listener<span class="token operator">&lt;</span>XHRResponse<span class="token operator">&gt;</span><span class="token punctuation">,</span>\n        ontimeout<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><h3 id="gm-log" tabindex="-1"><a class="header-anchor" href="#gm-log" aria-hidden="true">#</a> GM_log *</h3><blockquote><p>日志函数,后台脚本的日志将在控制面板的运行日志中看到(点击运行状态栏).相比于tm增加了一个日志的level.</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_log</span><span class="token punctuation">(</span>message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> level<span class="token operator">?</span><span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>LoggerLevel<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>\n<span class="token keyword">declare</span> <span class="token keyword">namespace</span> GM_Types <span class="token punctuation">{</span>\n    <span class="token keyword">type</span> <span class="token class-name">LoggerLevel</span> <span class="token operator">=</span> <span class="token string">&#39;debug&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;info&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;warn&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;error&#39;</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="gm-get-set-deletevalue" tabindex="-1"><a class="header-anchor" href="#gm-get-set-deletevalue" aria-hidden="true">#</a> GM_get/set/deleteValue</h3><blockquote><p>从储存中获取或者设置值,数据在同一<code>namespace</code>中可以共享,且可以实时的同步.</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 添加数据,请注意数据只能为bool;string;number;object四种类型,不能存储对象实例</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_setValue</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token comment">// 获取数据</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_getValue</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> defaultValue<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>\n<span class="token comment">// 删除数据,再获取会返回undefined或defaultValue</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_deleteValue</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="gm-add-removevaluechangelistener" tabindex="-1"><a class="header-anchor" href="#gm-add-removevaluechangelistener" aria-hidden="true">#</a> GM_add/removeValueChangeListener *</h3><blockquote><p>对值的监听操作,add会返回一个监听id,使用remove可以取消监听.后台脚本监听会返回tabid.</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// tabid是只有后台脚本监听才有的参数,获得tabid后可以使用GM_cookie(&#39;store&#39;)获取页面的cookie储存空间</span>\n<span class="token keyword">type</span> <span class="token class-name">ValueChangeListener</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> oldValue<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> newValue<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">,</span> remote<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span> tabid<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">;</span>\n\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_addValueChangeListener</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> listener<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>ValueChangeListener<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>\n\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_removeValueChangeListener</span><span class="token punctuation">(</span>listenerId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="gm-openintab" tabindex="-1"><a class="header-anchor" href="#gm-openintab" aria-hidden="true">#</a> GM_openInTab</h3><blockquote><p>打开一个新窗口</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_openInTab</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> options<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>OpenTabOptions<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_openInTab</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> loadInBackground<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_openInTab</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span>\n\n<span class="token keyword">declare</span> <span class="token keyword">namespace</span> GM_Types <span class="token punctuation">{</span>\n    <span class="token keyword">interface</span> <span class="token class-name">OpenTabOptions</span> <span class="token punctuation">{</span>\n        active<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>\n        insert<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>\n        setParent<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="gm-get-savetab-gm-gettabs" tabindex="-1"><a class="header-anchor" href="#gm-get-savetab-gm-gettabs" aria-hidden="true">#</a> GM_get/saveTab/GM_getTabs</h3><blockquote><p>类似GM_setValue的一个储存数据的方法,但是本方法的生命周期为一个浏览器页面窗口的打开-&gt;关闭,后台脚本中无法使用</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 获取tab数据</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_getTab</span><span class="token punctuation">(</span><span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span>obj<span class="token operator">:</span> object<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token comment">// 保存tab数据</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_saveTab</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n<span class="token comment">// 获取所有tab数据</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_getTabs</span><span class="token punctuation">(</span><span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span>objs<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">]</span><span class="token operator">:</span> object <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="gm-setclipboard" tabindex="-1"><a class="header-anchor" href="#gm-setclipboard" aria-hidden="true">#</a> GM_setClipboard</h3><blockquote><p>设置剪辑板</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_setClipboard</span><span class="token punctuation">(</span>data<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> info<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token punctuation">{</span> type<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> minetype<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="gm-addstyle" tabindex="-1"><a class="header-anchor" href="#gm-addstyle" aria-hidden="true">#</a> GM_addStyle</h3><blockquote><p>添加样式到页面中,返回样式DOM</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_addStyle</span><span class="token punctuation">(</span>css<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="gm-registermenucommand" tabindex="-1"><a class="header-anchor" href="#gm-registermenucommand" aria-hidden="true">#</a> GM_registerMenuCommand</h3><blockquote><p>注册一个菜单选项到弹出页面中,点击时会调用<code>listener</code>方法,如果注册多个同名菜单,则只会第一个生效</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_registerMenuCommand</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> listener<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">,</span> accessKey<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="gm-unregistermenucommand" tabindex="-1"><a class="header-anchor" href="#gm-unregistermenucommand" aria-hidden="true">#</a> GM_unregisterMenuCommand</h3><blockquote><p>通过id删除一个已经注册了的菜单项</p></blockquote><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_unregisterMenuCommand</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="gm-getresourcetext-gm-getresourceurl" tabindex="-1"><a class="header-anchor" href="#gm-getresourcetext-gm-getresourceurl" aria-hidden="true">#</a> GM_getResourceText/GM_getResourceURL</h3><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">//GM_getResourceText 获取资源文本数据,image等byte类型的数据会返回空文本,需要使用GM_getResourceURL获取</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_getResourceText</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>\n<span class="token comment">//GM_getResourceURL 获取经过base64后的数据</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_getResourceURL</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="gm-download" tabindex="-1"><a class="header-anchor" href="#gm-download" aria-hidden="true">#</a> GM_download</h3><p>下载文件,可设置header等内容,相比tm多了cookie和anonymous的功能,如果为blob url,将会直接打开下载,只有onload事件,这是与tm不同的一个特性(为后台脚本无法创建下载而服务,可能会在一些生成报表的场景使用到)</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_download</span><span class="token punctuation">(</span>details<span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>DownloadDetails<span class="token punctuation">)</span><span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>AbortHandle<span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n<span class="token keyword">declare</span> <span class="token keyword">function</span> <span class="token function">GM_download</span><span class="token punctuation">(</span>url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> filename<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> GM_Types<span class="token punctuation">.</span>AbortHandle<span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>\n\n<span class="token keyword">declare</span> <span class="token keyword">namespace</span> GM_Types <span class="token punctuation">{</span>\n\n    <span class="token keyword">interface</span> <span class="token class-name">DownloadError</span> <span class="token punctuation">{</span>\n        error<span class="token operator">:</span> <span class="token string">&#39;not_enabled&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;not_whitelisted&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;not_permitted&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;not_supported&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;not_succeeded&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;unknown&#39;</span><span class="token punctuation">,</span>\n        details<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>\n    <span class="token punctuation">}</span>\n\n    <span class="token keyword">interface</span> <span class="token class-name">DownloadDetails</span> <span class="token punctuation">{</span>\n        method<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#39;GET&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;POST&#39;</span>\n        url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        headers<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>\n        saveAs<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>\n        timeout<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span>\n        cookie<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>\n        anonymous<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>\n\n        onerror<span class="token operator">?</span><span class="token operator">:</span> Listener<span class="token operator">&lt;</span>DownloadError<span class="token operator">&gt;</span><span class="token punctuation">,</span>\n        ontimeout<span class="token operator">?</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">,</span>\n        onload<span class="token operator">?</span><span class="token operator">:</span> Listener<span class="token operator">&lt;</span>object<span class="token operator">&gt;</span><span class="token punctuation">,</span>\n        onprogress<span class="token operator">?</span><span class="token operator">:</span> Listener<span class="token operator">&lt;</span>XHRProgress<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;&gt;</span>\n    <span class="token punctuation">}</span>\n\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div>',39),f={render:function(n,s){const a=(0,p.up)("OutboundLink"),f=(0,p.up)("RouterLink");return(0,p.wg)(),(0,p.j4)(p.HY,null,[e,t,(0,p.Wm)("p",null,[o,(0,p.Wm)("a",l,[c,(0,p.Wm)(a)]),r]),(0,p.Wm)("p",null,[i,u,k,(0,p.Wm)(f,{to:"/dev/cat-api.html"},{default:(0,p.w5)((()=>[b])),_:1})]),d,(0,p.Wm)("blockquote",null,[m,(0,p.Wm)("p",null,[(0,p.Wm)("a",g,[y,(0,p.Wm)(a)])])]),h],64)}}}}]);